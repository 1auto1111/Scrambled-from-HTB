üß† Scrambled ‚Äî HTB Machine Walkthrough

Difficulty: Medium
OS: Windows
Type: Active Directory / Kerberos Abuse

üìù Overview

Scrambled is a retired Hack The Box machine that demonstrates classic Active Directory attack techniques with a focus on Kerberos authentication abuse. The objective is to gain an initial foothold through web enumeration, leverage Kerberos to escalate privileges, and finally obtain SYSTEM access.

üõ†Ô∏è Attack Summary

Service Enumeration
‚Ä¢ Identify a web application running on the target.
‚Ä¢ Perform thorough enumeration to discover credentials or login vectors.

Initial Access
‚Ä¢ Find valid credentials for a low-privileged user (e.g., ksimpson).
‚Ä¢ NTLM is disabled ‚Äî Kerberos is enforced, driving the use of Kerberos-centric attacks.

Kerberoasting
‚Ä¢ Enumerate accounts with Service Principal Names (SPNs).
‚Ä¢ Extract the Kerberos ticket for a service account (e.g., SqlSvc).
‚Ä¢ Crack the ticket offline to recover the plaintext service account password.

Abuse Service Account
‚Ä¢ Use the cracked credentials to authenticate to services such as MSSQL.
‚Ä¢ Generate a Silver Ticket to impersonate elevated users where appropriate.

Lateral Movement & Privilege Escalation
‚Ä¢ Leverage access to find additional credentials (e.g., MiscSvc).
‚Ä¢ Use PowerShell Remoting or equivalent to achieve code execution as the new user.

Privilege Escalation to SYSTEM
‚Ä¢ Analyze the environment for misconfigurations or insecure application usage.
‚Ä¢ Identify a .NET application using insecure deserialization (BinaryFormatter).
‚Ä¢ Craft a gadget chain to execute arbitrary code as SYSTEM.

üßæ Key Concepts Covered

Web application enumeration

Kerberos authentication fundamentals

Kerberoasting SPNs

Silver Ticket abuse

MSSQL authentication and exploitation

Insecure deserialization in .NET
